{% extends 'base.html'%}

{% block title %}爬虫{% endblock %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static',filename='css/crawl.css') }}">
    <script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>
	<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="{{ url_for('static',filename='js/city.js') }}" ></script>
{% endblock %}

{% block main %}
    <form action="" method="POST">
    <div class="form-group">
            <label for="scene">选择场景</label>
                <select class="form-control" id="scenes" list="scenes" name="scene">
                    <option value="居民区">居民区</option>
                    <option value="医院">医院</option>

                </select>
           <label for="province">选择省份</label>
            <select class="form-control" id="province" name="province"></select>
            <label for="city">选择城市</label>
            <select class="form-control" id="city" name="city"></select>
        </div>


<script>
    (function(){
        var pHtmlStr = '';
        for(var name in pc){
            pHtmlStr = pHtmlStr + '<option>'+name+'</option>';
        }
        $("#province").html(pHtmlStr);
        $("#province").change(function(){
            var pname = $("#province option:selected").text();
            var pHtmlStr = '';
            var cityList = pc[pname];
            for(var index in cityList){
                pHtmlStr = pHtmlStr + '<option>'+cityList[index]+'</option>';
            }
            $("#city").html(pHtmlStr);
        });
        $("#province").change();
    })();

</script>
<div class="form-container01" >
    <div class="table-group">

        <input type="text" class="form-control" placeholder="请输入ADSL_URL" name="ADSL_SERVER_URL">
    </div>
    <div class="table-group">
        <input type="text" class="form-control" placeholder="请输入ADSL_AUTH" name="ADSL_SERVER_AUTH">
    </div>
    <div class="table-group">
        <input type="text" class="form-control" placeholder="请输入KEY" name="KEY">
    </div>
    <div class="table-group">
        <input type="text" class="form-control" placeholder="请输入爬取起始网格数量" name="final_grid">
    </div>
    <div class="form-group">
        <input type="submit" class="btn btn-default" value="开始爬取"/>
    </div>
</div>


<div class="form-container02" id="log" >
   <p>用户名：{{username}}</p>
   <p>邮箱：{{email}}</p>
    <p>爬取{{city}}{{scene}}场景</p>
   <p>{{ log }}</p>
   <p>状态:{{ msg }}</p>
</div>

<script>


function refreash() {


    $.ajax({
        type: "get",
        async: false, //同步请求
        url: "/something/",
        //  timeout: 3000,
        success: function (dates) {
            $("#log").html(dates);//要刷新的div
            var boxId="log";
            var boxElement=document.getElementById(boxId);
            boxElement.scrollTop=boxElement.scrollHeight-boxElement.clientHeight;
        },
        error: function () {
            // alert("失败，请稍后再试！")
        }


    });

}
//setInterval("refreash()",3000);


</script>


</form>
{% endblock %}

